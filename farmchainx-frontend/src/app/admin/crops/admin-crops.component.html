<h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
  ðŸŒ± Crops
</h2>

<!-- ================= FILTER BAR ================= -->
<div class="flex flex-wrap gap-4 mb-6 items-center">

  <!-- SEARCH -->
  <input
    type="text"
    placeholder="Search crops..."
    class="px-4 py-2 border rounded-lg w-64"
    (input)="search = $any($event.target).value"
  />

  <!-- STATUS FILTER -->
  <select
    class="px-3 py-2 border rounded-lg"
    (change)="statusFilter = $any($event.target).value"
  >
    <option value="ALL">All Status</option>
    <option value="PLANTED">Planted</option>
    <option value="HARVESTED">Harvested</option>
    <option value="SOLD">Sold</option>
  </select>

</div>

<div *ngIf="loading" class="text-gray-500">
  Loading crops...
</div>

<!-- ================= CROPS TABLE ================= -->
<table *ngIf="!loading" class="w-full bg-white rounded shadow">
  <thead class="bg-gray-100">
    <tr>
      <th class="p-3 text-left">Name</th>
      <th class="p-3 text-left">Type</th>
      <th class="p-3 text-left">Quantity</th>
      <th class="p-3 text-left">Price</th>
      <th class="p-3 text-left">Batch</th>
      <th class="p-3 text-left">Status</th>
      <th class="p-3 text-right">Actions</th>
    </tr>
  </thead>

  <tbody>
    <tr *ngFor="let c of filteredCrops" class="border-t hover:bg-gray-50">

      <td class="p-3 font-medium">{{ c.cropName }}</td>
      <td class="p-3">{{ c.cropType }}</td>
      <td class="p-3">{{ c.quantity }}</td>
      <td class="p-3">â‚¹{{ c.price }}</td>

      <td class="p-3 font-mono text-sm">
        {{ c.batchId || '-' }}
      </td>

      <!-- STATUS BADGE -->
      <td class="p-3">
        <span
          class="px-3 py-1 rounded-full text-xs font-semibold"
          [ngClass]="{
            'bg-blue-100 text-blue-700': c.status === 'PLANTED',
            'bg-green-100 text-green-700': c.status === 'HARVESTED',
            'bg-purple-100 text-purple-700': c.status === 'SOLD'
          }"
        >
          {{ c.status }}
        </span>
      </td>

      <!-- ACTIONS -->
      <td class="p-3 text-right">
        <a
          *ngIf="c.batchId"
          class="text-blue-600 mr-3 hover:underline"
          [routerLink]="['/trace', c.batchId]"
          target="_blank"
        >
          Trace
        </a>

        <button
          class="text-red-600 hover:underline"
          (click)="deleteCrop(c.cropId)"
        >
          Delete
        </button>
      </td>
    </tr>
  </tbody>
</table>

<!-- EMPTY STATE -->
<div *ngIf="!loading && filteredCrops.length === 0"
     class="text-center text-gray-500 mt-10">
  No crops found.
</div>
